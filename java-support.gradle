
/**
 * Common Gradle script configuration for Java projects and tasks.
 * 
 * @author Emanuel Rabina
 */

project.ext.artifact = ''

sourceSets {
	main {
		java {
			srcDir 'Java'
		}
		output.classesDir = 'Classes'
	}
}

def archiveName() {
	return "${project.artifact}-${project.version}.jar";
}

/**
 * Create a list of all immediate dependencies.
 *
 * @return Comma-seperated list of dependencies.
 */
def listDependencies() {
	def deps = '';
	configurations.compile.dependencies.each {
		deps += "${it.name}-${it.version}.jar, "
	}
	return !deps.isEmpty() ? deps.substring(0, deps.length() - 2) : deps;
}

/**
 * Reconfigure the JAR task to create a manifest file with some extra
 * information.
 */
jar {
	archiveName = "${ -> archiveName() }"
	manifest {
		attributes 'Class-Path': "${ -> listDependencies() }"
	}
}
